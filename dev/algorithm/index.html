<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Algorithm · DividedRectangles.jl</title><meta name="title" content="Algorithm · DividedRectangles.jl"/><meta property="og:title" content="Algorithm · DividedRectangles.jl"/><meta property="twitter:title" content="Algorithm · DividedRectangles.jl"/><meta name="description" content="Documentation for DividedRectangles.jl."/><meta property="og:description" content="Documentation for DividedRectangles.jl."/><meta property="twitter:description" content="Documentation for DividedRectangles.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">DividedRectangles.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../installation/">Installation</a></li><li><a class="tocitem" href="../usage/">Usage</a></li><li class="is-active"><a class="tocitem" href>Algorithm</a><ul class="internal"><li><a class="tocitem" href="#Splitting-Intervals"><span>Splitting Intervals</span></a></li><li><a class="tocitem" href="#Practical-Implementations:"><span>Practical Implementations:</span></a></li></ul></li><li><a class="tocitem" href="../credits/">Credits</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Algorithm</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Algorithm</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/sisl/DividedRectangles.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/sisl/DividedRectangles.jl/blob/main/docs/src/algorithm.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Algorithm"><a class="docs-heading-anchor" href="#Algorithm">Algorithm</a><a id="Algorithm-1"></a><a class="docs-heading-anchor-permalink" href="#Algorithm" title="Permalink"></a></h1><p>The divided rectangles algorithm, or DIRECT (for DIvided RECTangles), incrementally refines a retangular partition of the design space. The refinement is driven a heuristic that involves reasoning about potential Lipschitz constants.</p><hr/><h3 id="Key-Concepts-of-the-DIRECT-Algorithm"><a class="docs-heading-anchor" href="#Key-Concepts-of-the-DIRECT-Algorithm">Key Concepts of the DIRECT Algorithm</a><a id="Key-Concepts-of-the-DIRECT-Algorithm-1"></a><a class="docs-heading-anchor-permalink" href="#Key-Concepts-of-the-DIRECT-Algorithm" title="Permalink"></a></h3><ol><li><strong>Division of Search Space</strong>:<ul><li>The algorithm begins by treating the entire feasible region as a single hyper-rectangle.</li><li>The search space is normalized to the unit hypercube to avoid oversensitivity to dimensions with larger domains. If minimizing <span>$f(x)$</span> in the interval between lower and upper ranges <span>$a$</span> and <span>$b$</span>, DIRECT will instead minimize:</li></ul></li></ol><p class="math-container">\[   g(\mathbf{x}) = f(\mathbf{x} \odot (\mathbf{b} - \mathbf{a}) + \mathbf{a})\]</p><p>After finding the minimum <span>$x^*$</span> of <span>$g$</span>, the minimum of <span>$f$</span> is</p><p class="math-container">\[\mathbf{x}^* \odot (\mathbf{b} - \mathbf{a}) + \mathbf{a}\]</p><hr/><ul><li>The figure below shows DIRECT method after 16 iterations on the Branin function. The cells are much denser around the minima of the Branin function because the DIRECT method is designed to increase resolution in promising regions.</li></ul><p><img src="https://github.com/user-attachments/assets/b833bedd-41aa-40c5-a27f-26188a171797" alt="page_11"/></p><hr/><ol><li><p><strong>Function Evaluation</strong>:</p><ul><li>The function is evaluated at the center of each hyper-rectangle.</li><li>Each interval has a center <span>$c^{(i)}$</span>  and an associated objective function value <span>$f(c^{(i)})$</span>, as well as a radius <span>$r^{(i)}$</span>, which is the distance from the center to a vertex.</li></ul></li><li><p><strong>Selection of Potentially Optimal Rectangles</strong>:</p><ul><li>After evaluation, the algorithm identifies potentially optimal rectangles. A rectangle is considered potentially optimal if it could contain the global minimum based on the evaluations performed so far.</li></ul></li><li><p><strong>Lipschitz Lower Bound</strong>:</p><ul><li>The Lipschitz lower bound for an interval is a circular cone extending downward from its center <span>$c^{(i)}$</span></li></ul></li></ol><p class="math-container">\[f(\mathbf{x}) \geq f(\mathbf{c}^{(i)}) - \ell \|\mathbf{x} - \mathbf{c}^{(i)}\|_2\]</p><ul><li>This lower bound is constrained by the extents of the interval, and its lowest value is achieved at the vertices, which are all a distance <span>$r^{(i)}$</span> from the center.</li></ul><p class="math-container">\[f(c^{(i)}) - \ell r^{(i)}\]</p><hr/><ul><li>The left plot shows the intervals for the DIRECT method after 5 iterations on the Branin function. The right plot shows the interval objective function values versus their radii, which is useful for identifying intervals to split with further evaluations.</li></ul><p><img src="https://github.com/user-attachments/assets/34da1f5e-c983-45cc-8b6c-531184d4b756" alt="page_12"/></p><ul><li>The left plot shows the Lipschitz lowerbounds constructed for the DIRECT intervals using the Lipschitz constant = 200, and highlights one interval. The right plot shows how the minimum value for the lowerbound within the highlighted interval is the same as the x-intercept for a line of slope passing through that interval’s <span>$(r, f(c))$</span> point.</li></ul><p><img src="https://github.com/user-attachments/assets/f023e6b0-ee8a-48fb-a8b6-c1b68d819377" alt="page_13"/></p><ul><li>The left plot continues to show the Lipschitz lowerbounds constructed for the DIRECT intervals using the Lipschitz constant = 200, but now highlights the interval containing the lowest value. The right plot shows how the lowest lowerbound for a given Lipschitz constant is the one with the lowest x-intercept in the right-hand plot.</li></ul><p><img src="https://github.com/user-attachments/assets/7df39f70-2ef2-4eaa-a5de-54f93d21e653" alt="page_14"/></p><hr/><ol><li><p><strong>Recursive Division</strong>:</p><ul><li>The selected rectangles are further divided, splitting into thirds along the axis directions. The order in which dimensions are split matters; lower function evaluations receive larger sub-rectangles. The process continues recursively, refining the search by focusing on the most promising regions.</li></ul></li><li><p><strong>Convex Hull</strong>:</p><ul><li>The DIRECT method selects all intervals for which a Lipschitz constant exists such that their lower bounds have minimal value. These intervals form a piecewise-linear boundary along the lower-right of the <span>$(r, f(c))$</span> space.</li></ul></li></ol><hr/><ul><li>The left plot shows the split intervals identified for this iteration of DIRECT on the Branin function. The right plot shows the lower-right convex hull formed by these split intervals in <span>$(r, f(c))$</span> space.</li></ul><p><img src="https://github.com/user-attachments/assets/5142788b-814e-4221-b50f-1746672278df" alt="page_15"/></p><hr/><h2 id="Splitting-Intervals"><a class="docs-heading-anchor" href="#Splitting-Intervals">Splitting Intervals</a><a id="Splitting-Intervals-1"></a><a class="docs-heading-anchor-permalink" href="#Splitting-Intervals" title="Permalink"></a></h2><p>When splitting a region without equal side lengths, only the longest dimensions are split. Splitting proceeds on these dimensions in the same manner as with a hypercube. The width in a given dimension depends on how many times that dimension has been split. Since DIRECT always splits axis directions by thirds, a dimension that has been split d times will have a width of <span>$3^−d$</span>. If we have <span>$n$</span> dimensions and track how many times each dimension of a given interval has been split in a vector <span>$d$</span>, then the radius of that interval is</p><p class="math-container">\[r = \left\|\left[ \frac{1}{2 \cdot 3^{-d_1}}, \dots, \frac{1}{2 \cdot 3^{-d_n}} \right]\right\|_2\]</p><hr/><ul><li><p><strong>Interval splitting in multiple dimensions for DIRECT</strong> requires choosing an ordering for the split dimensions:</p><p><img src="https://github.com/user-attachments/assets/962993d9-372a-4733-9d1f-0260cdacdff1" alt="page_16"/></p></li><li><p><strong>DIRECT will only split the longest dimensions of intervals</strong>. The algorithm only divides intervals larger than a minimum radius. This minimum radius prevents inefficient function evaluations very close to existing points:</p><p><img src="https://github.com/user-attachments/assets/99caea66-02b5-4371-90e2-69305c035ddf" alt="page_17"/></p></li></ul><hr/><h2 id="Practical-Implementations:"><a class="docs-heading-anchor" href="#Practical-Implementations:">Practical Implementations:</a><a id="Practical-Implementations:-1"></a><a class="docs-heading-anchor-permalink" href="#Practical-Implementations:" title="Permalink"></a></h2><ul><li>Struct <code>DirectRectangle</code>:</li></ul><pre><code class="language-julia hljs">   struct DirectRectangle
    c  # center point
    y  # center point value
    d  # number of divisions per dimension
    r  # the radius of the interval
end</code></pre><ul><li><code>direct</code> Function:</li></ul><pre><code class="language-julia hljs">function direct(f, a, b, k_max, r_min)
    g = x -&gt; f(x .* (b - a) + a)  # evaluate within unit hypercube
    n = length(a)
    c = fill(0.5, n)
    □s = [DirectRectangle(c, g(c), fill(0, n), sqrt(0.5^n))]
    c_best = c
    for k in 1 : k_max
        □s_split = get_split_intervals(□s, r_min)
        setdiff!(□s, □s_split)
        for □_split in □s_split
            append!(□s, split_interval(□_split, g))
        end
        c_best = □s[findmin(□.y for □ in □s)[2]].c
    end
    return c_best .* (b - a) + a  # from unit hypercube
end</code></pre><ul><li><code>is_ccw</code> Function:</li></ul><pre><code class="language-julia hljs">function is_ccw(a, b, c)
    return a.r * (b.y - c.y) - a.y * (b.r - c.r) + (b.r * c.y - b.y * c.r) &lt; 1e-6
end</code></pre><ul><li><code>get_split_intervals</code>Function</li></ul><pre><code class="language-julia hljs">function get_split_intervals(□s, r_min)
    hull = DirectRectangle[]
    sort!(□s, by = □ -&gt; (□.r, □.y))
    for □ in □s
        if length(hull) &gt;= 1 &amp;&amp; □.r == hull[end].r
            continue  # Repeated r values cannot be improvements
        end
        if length(hull) &gt;= 1 &amp;&amp; □.y ≤ hull[end].y
            pop!(hull)  # Remove the last point if the new one is better
        end
        if length(hull) &gt;= 2 &amp;&amp; is_ccw(hull[end-1], hull[end], □)
            pop!(hull)
        end
        push!(hull, □)
    end
    filter!(□ -&gt; □.r ≥ r_min, hull)  # Only split intervals larger than the minimum radius
    return hull
end</code></pre><ul><li><code>split_interval</code> Function:</li></ul><pre><code class="language-julia hljs">function split_interval(□, g)
    c, n, d_min, d = □.c, length(□.c), minimum(□.d), copy(□.d)
    dirs, δ = findall(d .== d_min), 3.0^(-d_min-1)
    Cs = [(c + δ*basis(i, n), c - δ*basis(i, n)) for i in dirs]
    Ys = [(g(C[1]), g(C[2])) for C in Cs]
    minvals = [min(Y[1], Y[2]) for Y in Ys]
    □s = DirectRectangle[]
    for j in sortperm(minvals)
        d[dirs[j]] += 1  # Increment the number of splits
        C, Y, r = Cs[j], Ys[j], norm(0.5 * 3.0.^(-d))
        push!(□s, DirectRectangle(C[1], Y[1], copy(d), r))
        push!(□s, DirectRectangle(C[2], Y[2], copy(d), r))
    end
    r = norm(0.5 * 3.0.^(-d))
    push!(□s, DirectRectangle(c, □.y, d, r))
    return □s
end</code></pre><hr/><h3 id="Strengths-of-the-DIRECT-Algorithm"><a class="docs-heading-anchor" href="#Strengths-of-the-DIRECT-Algorithm">Strengths of the DIRECT Algorithm</a><a id="Strengths-of-the-DIRECT-Algorithm-1"></a><a class="docs-heading-anchor-permalink" href="#Strengths-of-the-DIRECT-Algorithm" title="Permalink"></a></h3><p>The strength of the DIRECT algorithm lies in its ability to systematically explore the entire search space while focusing on the most promising areas. This systematic coverage helps the algorithm escape local minima, making it particularly effective for objective functions with multiple local minima. By not requiring the Lipschitz constant, the DIRECT algorithm is adaptable to various optimization problems, including those where the smoothness of the objective function is not well understood.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../usage/">« Usage</a><a class="docs-footer-nextpage" href="../credits/">Credits »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Sunday 22 September 2024 16:13">Sunday 22 September 2024</span>. Using Julia version 1.10.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
